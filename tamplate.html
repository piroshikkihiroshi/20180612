<html>

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title></title>
	<link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css">
	<script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
	<script src="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script>

    <script>
        $(function () { //init
            //Header include
            var strHeadPath = '../header.jsp';
            $("#head").load(strHeadPath);

            // 半角英数以外入力不可イベント
            $('#UserId').on('input', function () {
                var strVal = $(this).val();
                $(this).val(strVal.replace(/[^0-9a-zA-Z]/g, ""));
            });
        });

        function addUser() {

            //バリデーション
            var strErrVal = "";
            var blRet = false;
            blRet = validationFrom("UserId", 1)
            if (!blRet) strErrVal += "ユーザIDを入力してください。<br/>";
            blRet = validationFrom("UserId", 2)
            if (!blRet) strErrVal += "ユーザIDは半角英数字で入力してください。<br/>";
            blRet = validationFrom("Password", 1)
            if (!blRet) strErrVal += "パスワードを入力してください。<br/>";
            blRet = validationFrom("Password", 2)
            if (!blRet) strErrVal += "パスワードは半角英数字で入力してください。<br/>";
            blRet = validationFrom("UserName", 1)
            if (!blRet) strErrVal += "ユーザ名を入力してください。<br/>";

            if (strErrVal == "") {
                var strUserName = document.getElementById('UserName').value;
                if (window.confirm('ユーザ「' + strUserName + '」を追加しますがよろしいですか？')) {
                    var objForm = document.getElementById('addForm');
                    var objFormData = new FormData(objForm); // FormData オブジェクトを作成
                    var strHtml = "";
                    strHtml += "<div class='alert alert-warning role='alert''>";
                    strHtml += "ユーザ追加中です。しばらくお待ちください。";
                    strHtml += "</div>";
                    strHtml += ' <div class="loading"></div>';
                    $('#loadId').html(strHtml); //load中にする

                    $.ajax({
                        type: 'POST',
                        url: '/EELearning/UserAdd',
                        data: objFormData,
                        processData: false, // Ajaxがdataを整形しない指定
                        contentType: false, // contentTypeもfalseに指定(Fileをアップロード時は必要)
                        success: function (data) {
                            $('#loadId').html(data); //戻ってきたデータと入れ替える
                            console.log("success");
                            return false;
                        }
                    });
                }


            } else {
                var objErrDom = document.getElementById("errMsg");
                objErrDom.outerHTML = '<div id="errMsg" class="alert alert-warning">' + strErrVal + '</div>';
            }

        }

        function modUser(strFormName_i, strUserName_i) {

            //	var strUserName = document.getElementById('UserName').value;
            if (window.confirm('ユーザ「' + strUserName_i + '」を更新しますがよろしいですか？')) {
                var objForm = document.getElementById(strFormName_i);
                var objFormData = new FormData(objForm); // FormData オブジェクトを作成
                var strHtml = "";
                strHtml += "<div class='alert alert-warning role='alert''>";
                strHtml += "ユーザ更新中です。しばらくお待ちください。";
                strHtml += "</div>";
                strHtml += ' <div class="loading"></div>';
                $('#loadId').html(strHtml); //load中にする

                $.ajax({
                    type: 'POST',
                    url: '/EELearning/userMod',
                    data: objFormData,
                    processData: false, // Ajaxがdataを整形しない指定
                    contentType: false, // contentTypeもfalseに指定(Fileをアップロード時は必要)
                    success: function (data) {
                        $('#loadId').html(data); //戻ってきたデータと入れ替える
                        console.log("success");
                        return false;
                    }
                });
            }


        }

        function delUser(strFormName_i, strUserName_i) {

            //	var strUserName = document.getElementById('UserName').value;
            if (window.confirm('ユーザ「' + strUserName_i + '」を削除しますがよろしいですか？')) {
                var objForm = document.getElementById(strFormName_i);
                var objFormData = new FormData(objForm); // FormData オブジェクトを作成
                var strHtml = "";
                strHtml += "<div class='alert alert-warning role='alert''>";
                strHtml += "ユーザ削除中です。しばらくお待ちください。";
                strHtml += "</div>";
                strHtml += ' <div class="loading"></div>';
                $('#loadId').html(strHtml); //load中にする

                $.ajax({
                    type: 'POST',
                    url: '/EELearning/userDel',
                    data: objFormData,
                    processData: false, // Ajaxがdataを整形しない指定
                    contentType: false, // contentTypeもfalseに指定(Fileをアップロード時は必要)
                    success: function (data) {
                        $('#loadId').html(data); //戻ってきたデータと入れ替える
                        console.log("success");
                        return false;
                    }
                });
            }


        }


    </script>
</head>







<body style="padding-top: 70px;">

    <!--header-->
    <div id="head">
        <nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="/EELearning/home/">
                    <span class="glyphicon glyphicon-home" id="logIcon"></span>
                </a>
            </div>
            <!-- Collect the nav links, forms, and other content for toggling -->
            <div class="collapse navbar-collapse navbar-ex1-collapse">
                <ul class="nav navbar-nav">


                    <li class="dropdown"> <a href="href=''" class="dropdown-toggle" data-toggle="dropdown"
                            title="Elearning Manage">Elearning Manage <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            <li><a href="/EELearning/eLearningManage/" title="Elearning make">Elearning make</a></li>
                            <li><a href="/EELearning/eLearningDel/" title="Elearning delete">Elearning delete</a></li>
                        </ul>
                    </li>


                    <li><a href="/EELearning/stateCheck/" title="Status Check">Status Check</a></li>


                    <li><a href="/EELearning/users/" title="Status Check">User Manage</a></li>

                </ul>

                <!-- user info -->
                <div class="collapse navbar-collapse navbar-right">
                    <ul class="nav navbar-nav">
                        <li><a href="javascript:void(0)" title="User">
                                <span class="glyphicon glyphicon-user" id="logIcon"></span>
                                上田 辰也 さん</a></li>
                        <li><a href="/EELearning/login/" title="logout">
                                <span class="glyphicon glyphicon-log-out" id="logIcon"></span>
                                Logout　</a></li>

                    </ul>
                </div>
            </div>
        </nav>

    </div>

    <div class="container">

        <div id="errMsg"></div>

        <div id="loadId">


            <div class="alert alert-info">ユーザの新規登録、更新、削除を行ってください。</div>
            <!-- Table -->
            <form name="addForm" id="addForm" method="post" enctype="multipart/form-data">
                <div class="panel panel-primary">
                    <div class="panel-heading">ユーザ登録</div>
                    <div class="table-responsive">
                        <table class="table table-striped table-bordered table-hover">
                            <thead>
                                <tr>
                                    <th>User Id</th>
                                    <th>Password</th>
                                    <th>UserName</th>
                                    <th>Authority</th>
                                    <th class="text-center">Regist</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>
                                        <div class="control-group">
                                            <label class="control-label" for="UserId"></label>
                                            <input type="text" id="UserId" name="UserId" placeholder="User Id">
                                        </div>
                                    </td>
                                    <td>
                                        <div class="control-group">
                                            <label class="control-label" for="Password"></label>
                                            <input type="password" id="Password" name="Password" placeholder="Password">
                                        </div>
                                    </td>
                                    <td>
                                        <div class="control-group">
                                            <label class="control-label" for="UserName"></label>
                                            <input type="text" id="UserName" name="UserName" placeholder="UserName">
                                        </div>
                                    </td>
                                    <td>
                                        <select class="form-control" id="Authority" name="Authority">
                                            <option value="1" selected="selected">利用者</option>
                                            <option value="2">運用者</option>
                                            <option value="3">管理者</option>
                                        </select>
                                    </td>
                                    <td>

                                        <input class="btn btn-primary  center-block" onclick="addUser()" value="Regist">
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <!--/table-responsive-->
                </div>
                <!--/panel-->
            </form>



            <!-- Table -->
            <div class="panel panel-primary">
                <div class="panel-heading">ユーザ更新、削除</div>

                <div class="table-responsive">
                    <table class="table table-striped table-bordered table-hover">
                        <thead>
                            <tr>
                                <th>User Name</th>
                                <th>Password</th>
                                <th>Authority</th>
                                <th class="text-center">Modify</th>
                                <th class="text-center">Delete</th>
                            </tr>
                        </thead>
                        <tbody>
                            <form name="modDelForm1" id="modDelForm1" method="post" enctype="multipart/form-data">
                            </form>
                            <tr><input type="hidden" name="UserId" value="117018">
                                <td>
                                    <div class="control-group"> <label class="control-label"></label> <input type="text"
                                            name="UserName" placeholder="User Name" value="松田"></div>
                                </td>
                                <td>
                                    <div class="control-group"> <label class="control-label"></label> <input
                                            type="password" name="Password" placeholder="Password" value="117018"></div>
                                </td>
                                <td> <select class="form-control" name="Authority">
                                        <option value="1" selected="selected">利用者</option>
                                        <option value="2">運用者</option>
                                        <option value="3">管理者</option>
                                    </select> </td>
                                <td><input class="btn btn-info center-block" onclick="modUser('modDelForm1','ueda')"
                                        value="Modify"></td>
                                <td><input class="btn btn-warning center-block" onclick="delUser('modDelForm1','ueda')"
                                        value="Delete"></td>
                            </tr>
                            <form name="modDelForm2" id="modDelForm2" method="post" enctype="multipart/form-data">
                            </form>
                            <tr><input type="hidden" name="UserId" value="test3">
                                <td>
                                    <div class="control-group"> <label class="control-label"></label> <input type="text"
                                            name="UserName" placeholder="User Name" value="あいうえお"></div>
                                </td>
                                <td>
                                    <div class="control-group"> <label class="control-label"></label> <input
                                            type="password" name="Password" placeholder="Password" value="aaaaa"></div>
                                </td>
                                <td> <select class="form-control" name="Authority">
                                        <option value="1" selected="selected">利用者</option>
                                        <option value="2">運用者</option>
                                        <option value="3">管理者</option>
                                    </select> </td>
                                <td><input class="btn btn-info center-block" onclick="modUser('modDelForm2','あいうえお')"
                                        value="Modify"></td>
                                <td><input class="btn btn-warning center-block" onclick="delUser('modDelForm2','あいうえお')"
                                        value="Delete"></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <!--/table-responsive-->
            </div>

            <!--/panel-->

        </div>
    </div>

</body>


</html>
